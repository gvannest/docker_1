# --detach ou -d pour l'execution en arrière plan
# --restart pour les comportement du conteneur en car d'arret
#   (cf: https://docs.docker.com/config/containers/start-containers-automatically/)
# --volume pour lier le conteneur à un volume
# --name pour le nom du conteneur
# --env définit des variables d'environnement pour le conteneur
# MYSQL_ROOT_PASSWORD et MYSQL_DATABASE sont des variables d'environnement spécifique
# à l'image mysql (cf: https://hub.docker.com/_/mysql)
# mysql est le nom de l'image

docker run \
        --detach \
        --restart on-failure \
        --volume hatchery:/var/lib/mysql \
        --name spawning-pool \
        --publish 3306:3306 \
        --env MYSQL_ROOT_PASSWORD='Kerrigan' \
        --env MYSQL_DATABASE='zerglings' \
    mysql --default-authentication-plugin=mysql_native_password

# /!\ la nouvelle méthode d'authentification de mysql n'est pas supporté par
# la dernière version de PHP, d'où la commande :
# "--default-authentication-plugin=mysql_native_password"
# il faut s'assuré que le volume associé soit reset à en cas d'oubli de se
# paramettre. https://github.com/docker-library/wordpress/issues/313
#
# Client:
# MySQL Connection Error: (1045) Access denied for user 'wpdemo'@'172.17.0.3' (using password: YES)
#
# WARNING: unable to establish a database connection to 'spawning-pool'
#  continuing anyways (which might have unexpected results)
#
# AH00558: apache2: Could not reliably determine the server's fully qualified domain name, using 172.17.0.3. Set the 'ServerName' directive globally to suppress this message
#
# Serveur:
# 2019-08-29T16:11:01.447172Z 17 [Warning] [MY-013360] [Server] Plugin sha256_password reported: ''sha256_password' is deprecated and will be removed in a future release. Please use caching_sha2_password instead'
